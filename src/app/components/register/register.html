<div class="form">
    <h1>Regístrate</h1>
    <form [formGroup]="form" (ngSubmit)="onSubmit()" [class.hidden]="isLoading()">
        <div>
            <div class="flex-col">
                <div class="input-group">
                    <i class="fas fa-user"></i>
                    <input type="text" placeholder="Nombre *" formControlName="firstname" />
                </div>
            </div>
            <div class="flex-col">
                <div class="input-group">
                    <i class="fas fa-user"></i>
                    <input type="text" placeholder="Apellido/s *" formControlName="lastname" />
                </div>
            </div>
        </div>
        @if((firstname?.invalid || lastname?.invalid) && (firstname?.touched || lastname?.touched)){
        <span class="validation">* Introduzca nombre y appellidos válidos</span>
        }
        <div class="input-group">
            <select formControlName="municipio">
                <option value="" disabled selected>Municipio</option>
                @for (muni of municipios; track $index) {
                <option [value]="muni">{{ muni }}</option>
                }
            </select>
        </div>
        <div>
            <div class="flex-col">
                <div class="input-group">
                    <i class="fas fa-map"></i>
                    <input type="text" placeholder="Calle *" formControlName="calle" />
                </div>
            </div>
            <div class="flex-col">
                <div class="input-group">
                    <i class="fas fa-map"></i>
                    <input type="text" placeholder="Nº de Calle *" formControlName="numero" />
                </div>
            </div>
        </div>

        @if((calle?.invalid || numero?.invalid) && (calle?.touched || numero?.touched)){
        <span class="validation">* Introduzca una calle y número válidos</span>
        }

        <div class="input-group">
            <i class="fas fa-phone"></i>
            <input type="text" placeholder="Teléfono *" formControlName="phoneNumber" />
        </div>

        @if(phoneNumber?.invalid && (phoneNumber?.touched || phoneNumber?.dirty)){
        <span class="validation">* Introduzca un número de teléfono válido en España (9 dígitos)</span>
        }

        <div class="input-group">
            <i class="fas fa-envelope"></i>
            <input type="text" placeholder="Correo electrónico *" formControlName="email" />
        </div>

        @if(email?.invalid && (email?.touched || email?.dirty)){
        <span class="validation">* Introduzca una dirección de correo válida</span>
        }

        <div class="input-group">
            <i class="fas fa-lock"></i>
            <input type="password" placeholder="Contraseña *" formControlName="password" />
        </div>
        @if(password?.invalid && (password?.touched || password?.dirty)){
        <span class="validation">* La contraseña debe tener al menos 6 dígitos</span>
        }

        @if (errorText) {
        <div>
            <span class="validation">{{errorText}}</span>
        </div>
        }

        <div>
            <button type="submit" [disabled]="form.invalid">Registrarse</button>
        </div>
    </form>

    @if (isLoading()) {
    <div class="loading">
        <i class="fas fa-spinner fa-spin"></i>
    </div>
    }

</div>